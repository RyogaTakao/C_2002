<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>文章補完機能</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="tiny_segmenter-0.2.js" type="text/javascript"></script>
    <script type="text/javascript">

      var businessIdioms = [
        ["お世話になっております", "おせわになっております"],
        ["早速のお返事ありがとうございました", "さっそくのおへんじありがとうございました"],
        ["よろしくお願いいたします", "よろしくおねがいいたします"],
        ["お返事お待ちしております", "おへんじおまちしております"],
        ["お手数をおかけしますが", "おてすうをおかけしますが"],
        ["引き続きよろしくお願いいたします", "ひきつづきよろしくおねがいいいたします"],
        ["ますますのご活躍をお祈り申し上げます", "ますますのごかつやくをおいのりもうしあげます"],
        ["申し訳ございません", "もうしわけございません"],
        ["今後ともよろしくお願い申し上げます", "こんごともよろしくおねがいもうしあげます"],
        ["ご無沙汰しております", "ごぶさたしております"],
        ["引き続き、どうぞよろしくお願いいたします", "ひきつづき、どうぞよろしくおねがいいたします"],
        ["お世話になっております", "おせわになっております"],
        ["承知しました", "しょうちしました"],
        ["お世話になります", "おせわになります"],
        ["貴社ますますご清栄のこととお喜び申し上げます", "きしゃますますごせいえいのこととおよろこびもうしあげます"],
        ["ますますご健勝のことと存じます", "ますますごけんしょうのこととぞんじます"],
        ["先日はお世話さまでした", "せんじつはおせわさまでした"],
        ["先日はごちそうさまでした", "せんじつはごちそうさまでした"],
        ["お変わりありませんか", "おかわりありませんか"],
        ["いかがお過ごしですか", "いかがおすごしですか"],
        ["先日は、お付き合い下さり、誠にありがとうございました", "せんじつは、おつきあいくださり、まことにありがとうございました"],
        ["突然のメールで失礼いたします", "とつぜんのめーるでしつれいいたします"],
        ["様よりメールアドレスを教えていただき連絡いたしております", "さまよりめーるあどれすをおしえていただきれんらくいたしております"],
        ["先ほどはお電話にて失礼いたしました", "さきほどはおでんわにてしつれいいたしました"],
        ["ご高配賜りますようお願い申し上げます", "ごこうはいたまわりますようおねがいもうしあげます"],
        ["あしからずご了承ください", "あしからずごりょうしょうください"],
        ["よろしくお伝えください", "よろしくおつたえください"],
        ["用件のみにて失礼します", "ようけんのみにてしつれいします"],
        ["決まり次第ご連絡させていただきます", "きまりしだいごれんらくさせていただきます"],
        ["分かり次第ご連絡させていただきます", "わかりしだいごれんらくさせていただきます"],
        ["ご返事いただければ、幸いです", "ごへんじいただければ、さいわいです"],
        ["お手数ですが、ご一読のうえご返信をお願いいたします", "おてすうですが、ごいちどくのうえごへんしんをおねがいいたします"],
        ["恐れ入りますが、ご確認のうえご返答をお願い申し上げます", "おそれいりますが、ごかくにんのうえごへんとうをおねがいもうしあげます"],
        ["至急、ご返信をお願いいたします", "しきゅう、ごへんしんをおねがいいたします"],
        ["詳細は打ち合わせの際に改めてお知らせいたします", "しょうさいはうちあわせのさいにあらためておしらせいたします"],
        ["明日、お会いできることを楽しみにしています", "あした、おあいできることをたのしみにしています"],
        ["ご参加をお待ちしています", "ごさんかをおまちしております"],
        ["不明な点があれば、遠慮なくお尋ねください", "ふめいなてんがあれば、えんりょなくおたずねください"],
        ["お近くにお越しの際は、ぜひお立ち寄りください", "おちかくにおこしのさいは、ぜひおたちよりください"],
        ["かしこまりました", "かしこまりました"],
        ["おかげさまで", "おかげさまで"],
        ["お力添えのおかげで", "おちからぞえのおかげで"],
        ["感銘を受けました", "かんめいをうけました"],
        ["感服いたしました", "かんぷくいたしました"],
        ["ご教示いただければ幸いです", "ごきょうじいただければさいわいです"],
        ["存じ上げません", "ぞんじあげません"],
        ["失念いたしました", "しつねんいたしました"],
        ["不徳のいたすところです", "ふとくのいたすところです"],
        ["お詫びの申し上げようもございません", "おわびのもうしあげようもございません"],
        ["ご多忙中とは存じますが", "ごたぼうちゅうとはぞんじますが"],
        ["メールにて回答をお願いします", "めーるにてかいとうをおねがいします"],
        ["心より感謝しております", "こころよりかんしゃしております"],
        ["深くお礼申し上げます", "ふかくおれいもうしあげます"],
        ["まずは御礼かたがたご連絡まで", "まずはおれいかたがたごれんらくまで"],
        ["取り急ぎ御礼まで", "とりいそぎおれいまで"],
        ["またお目にかかれる機会を楽しみにしております", "またおめにかかれるきかいをたのしみにしております"],
        ["心よりお詫び申し上げます", "こころよりおわびもうしあげます"],
        ["今後ともご指導のほど宜しくお願い申し上げます", "こんごともごしどうのほどよろしくおねがいもうしあげます"],
        ["何とぞご容赦の程、お願いいたします", "なにとぞごようしゃのほどおねがいいたします"],
        ["取り急ぎ、お詫びかたがた訂正のお願いまで", "とりいそぎ、おわびかたがたていせいのおねがいまで"],
        ["どうかご指導・ご鞭撻のほどよろしくお願い申し上げます", "どうかごしどう・ごべんたつのほどよろしくおねがいもうしあげます"],
        ["皆様におかれましては、日々業務に邁進しておられる事と存じます", "みなさまにおかれましては、ひびぎょうむにまいしんしておられることとぞんじます"],
        ["今後とも何卒よろしくおつきあいのほど、お願い申し上げます", "こんごともなにそよろしくおつきあいのほど、おねがいもうしあげます"],
        ["ご自愛くださいませ", "ごじあいくださいませ"],
        ["お忙しいところ恐縮ですが", "おいそがしいところきょうしゅくですが"],
        ["何卒宜しくお願い致します", "なにとぞよろしくおねがいいたします"],
        ["ご査収の程", "ごさしゅうのほど"],
        ["ご多用の折恐れ入りますが", "ごたようのおりおそれいりますが"],
        ["末筆ながら、貴社益々のご発展をお祈りいたします", "まっぴつながら、きしゃもろもろのはってんをおいのりいたします"],
        ["重ねて御礼申し上げます", "かさねておれいもうしあげます"],
        ["本日はお忙しい中", "ほんじつはおいそがしいなか "],
        ["貴重なお時間をいただきありがとうございました", "きちょうなおじかんをいただきありがとうございました"]

      ];
  
      jQuery(function(){  
        jQuery('#new_message').autocomplete({
          source: function(request, response){
            var suggestionList = [];
                segForSuggestion = new TinySegmenter();  
                morphForSuggestion = segForSuggestion.segment(request.term);
                unfinishedWord = morphForSuggestion.slice(-1)[0]; 
                regexp = new RegExp('^' + unfinishedWord + '.*$');
            
            jQuery.each(businessIdioms, function(i, businessIdiom) {
              if (unfinishedWord.length >= 2) {
                if (businessIdiom[0].match(regexp) || businessIdiom[1].match(regexp)) {
                  suggestionList.push(businessIdiom[0]);
                } 
              }  
            });

            response(suggestionList);
          },

          select: function (event, selectedPhrase) {  
            var segForSelection = new TinySegmenter();  
                morphForSelection= segForSelection.segment(this.value); 
            
            morphForSelection.pop();
            if (typeof(morphForSelection)=="string") {
              // ↓テキストボックスに消したい要素が入った(補完前の途中のひらがなだけ)リストが文字列に変化するので、新規で作成している
              var newMorphForSelection = [];
              newMorphForSelection.push(selectedPhrase.item.value);
              this.value = newMorphForSelection.join("");
            } else {
              morphForSelection.push(selectedPhrase.item.value);
              this.value = morphForSelection.join("")
            }
            return false;
          },
          autoFocus: true,
          delay: 300,
          minLength: 2,
          position: { my : "left bottom", at: "left top" },
        });
      });
      </script>
  </head>
  <body>
    <div class="ui_widget" style="position: absolute; width: 100%;margin: 100px; text-align: center;">
      <textarea id="new_message" cols="60" rows="20" placeholder="メール入力"></textarea>
    </div>
  </body>
</html>
